  // Calculate efficiency weighted exposure 
  // Combines data from two TGraphs with efficiency and Clopper-Pearson error bars
  #include "TMath.h"
  {
    TFile *f1 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch662.root");
    TGraphAsymmErrors *geff1 = (TGraphAsymmErrors*)f1->Get("Graph");
    TFile *f2 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch660.root");
    TGraphAsymmErrors *geff2 = (TGraphAsymmErrors*)f2->Get("Graph");
    TFile *f3 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch658.root");
    TGraphAsymmErrors *geff3 = (TGraphAsymmErrors*)f3->Get("Graph");
    //TFile *f4 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch692.root");
    //TGraphAsymmErrors *geff4 = (TGraphAsymmErrors*)f4->Get("Graph");
    TFile *f5 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch648.root");
    TGraphAsymmErrors *geff5 = (TGraphAsymmErrors*)f5->Get("Graph");
    TFile *f6 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch640.root");
    TGraphAsymmErrors *geff6 = (TGraphAsymmErrors*)f6->Get("Graph");
    TFile *f7 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch610.root");
    TGraphAsymmErrors *geff7 = (TGraphAsymmErrors*)f7->Get("Graph");
    TFile *f8 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch608.root");
    TGraphAsymmErrors *geff8 = (TGraphAsymmErrors*)f8->Get("Graph");
    TFile *f9 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch584.root");
    TGraphAsymmErrors *geff9 = (TGraphAsymmErrors*)f9->Get("Graph");
    TFile *f10 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch624.root");
    TGraphAsymmErrors *geff10 = (TGraphAsymmErrors*)f10->Get("Graph");
    TFile *f11 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch628.root");
    TGraphAsymmErrors *geff11 = (TGraphAsymmErrors*)f11->Get("Graph");
    TFile *f12 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch688.root");
    TGraphAsymmErrors *geff12 = (TGraphAsymmErrors*)f12->Get("Graph");
    TFile *f13 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch694.root");
    TGraphAsymmErrors *geff13 = (TGraphAsymmErrors*)f13->Get("Graph");
    TFile *f14 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch614.root");
    TGraphAsymmErrors *geff14 = (TGraphAsymmErrors*)f14->Get("Graph");
    TFile *f15 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch598.root");
    TGraphAsymmErrors *geff15 = (TGraphAsymmErrors*)f15->Get("Graph");
    TFile *f16 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch592.root");
    TGraphAsymmErrors *geff16 = (TGraphAsymmErrors*)f16->Get("Graph");
    TFile *f17 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch632.root");
    TGraphAsymmErrors *geff17 = (TGraphAsymmErrors*)f17->Get("Graph");
    TFile *f18 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch626.root");
    TGraphAsymmErrors *geff18 = (TGraphAsymmErrors*)f18->Get("Graph");
    TFile *f19 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch690.root");
    TGraphAsymmErrors *geff19 = (TGraphAsymmErrors*)f19->Get("Graph");
    TFile *f20 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch680.root");
    TGraphAsymmErrors *geff20 = (TGraphAsymmErrors*)f20->Get("Graph");
    TFile *f21 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch678.root");
    TGraphAsymmErrors *geff21 = (TGraphAsymmErrors*)f21->Get("Graph");
    TFile *f22 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch674.root");
    TGraphAsymmErrors *geff22 = (TGraphAsymmErrors*)f22->Get("Graph");
    TFile *f23 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch672.root");
    TGraphAsymmErrors *geff23 = (TGraphAsymmErrors*)f23->Get("Graph");
    //TFile *f24 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1124.root");
    //TGraphAsymmErrors *geff24 = (TGraphAsymmErrors*)f24->Get("Graph");
    TFile *f25 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1204.root");
    TGraphAsymmErrors *geff25 = (TGraphAsymmErrors*)f25->Get("Graph");
    TFile *f26 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1174.root");
    TGraphAsymmErrors *geff26 = (TGraphAsymmErrors*)f26->Get("Graph");
    TFile *f27 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1128.root");
    TGraphAsymmErrors *geff27 = (TGraphAsymmErrors*)f27->Get("Graph");
    TFile *f28 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1106.root");
    TGraphAsymmErrors *geff28 = (TGraphAsymmErrors*)f28->Get("Graph");
    TFile *f29 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1176.root");
    TGraphAsymmErrors *geff29 = (TGraphAsymmErrors*)f29->Get("Graph");
    TFile *f30 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1172.root");
    TGraphAsymmErrors *geff30 = (TGraphAsymmErrors*)f30->Get("Graph");
    TFile *f31 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1170.root");
    TGraphAsymmErrors *geff31 = (TGraphAsymmErrors*)f31->Get("Graph");
    TFile *f32 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1208.root");
    TGraphAsymmErrors *geff32 = (TGraphAsymmErrors*)f32->Get("Graph");
    TFile *f33 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1120.root");
    TGraphAsymmErrors *geff33 = (TGraphAsymmErrors*)f33->Get("Graph");
    TFile *f34 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1330.root");
    TGraphAsymmErrors *geff34 = (TGraphAsymmErrors*)f34->Get("Graph");
    //TFile *f35 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1332.root");
    //TGraphAsymmErrors *geff35 = (TGraphAsymmErrors*)f35->Get("Graph");
    TFile *f36 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1302.root");
    TGraphAsymmErrors *geff36 = (TGraphAsymmErrors*)f36->Get("Graph");
    TFile *f37 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1298.root");
    TGraphAsymmErrors *geff37 = (TGraphAsymmErrors*)f37->Get("Graph");
    TFile *f38 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1236.root");
    TGraphAsymmErrors *geff38 = (TGraphAsymmErrors*)f38->Get("Graph");
    TFile *f39 = new TFile("~/LowE/Data/IndivEfficiencies/ClopperErrorDS1Ch1232.root");
    TGraphAsymmErrors *geff39 = (TGraphAsymmErrors*)f39->Get("Graph");
      
    cout << "Loading data files" << endl;

    double eff1[20] = {};
    double eff2[20] = {};
    double eff3[20] = {};
    //double eff4[20] = {};
    double eff5[20] = {};
    double eff6[20] = {};
    double eff7[20] = {};
    double eff8[20] = {};
    double eff9[20] = {};
    double eff10[20] = {};
    double eff11[20] = {};
    double eff12[20] = {};
    double eff13[20] = {};
    double eff14[20] = {};
    double eff15[20] = {};
    double eff16[20] = {};
    double eff17[20] = {};
    double eff18[20] = {};
    double eff19[20] = {};
    double eff20[20] = {};
    double eff21[20] = {};
    double eff22[20] = {};
    double eff23[20] = {};
    //double eff24[20] = {};
    double eff25[20] = {};
    double eff26[20] = {};
    double eff27[20] = {};
    double eff28[20] = {};
    double eff29[20] = {};
    double eff30[20] = {};
    double eff31[20] = {};
    double eff32[20] = {};
    double eff33[20] = {};
    double eff34[20] = {};
    //double eff35[20] = {};
    double eff36[20] = {};
    double eff37[20] = {};
    double eff38[20] = {};
    double eff39[20] = {};
    double effSum[20] = {};
    double errhi1[20] = {};
    double errlow1[20] = {};
    double errhi2[20] = {};
    double errlow2[20] = {};
    double errhi3[20] = {};
    double errlow3[20] = {};
    //double errhi4[20] = {};
    //double errlow4[20] = {};
    double errhi5[20] = {};
    double errlow5[20] = {};
    double errhi6[20] = {};
    double errlow6[20] = {};
    double errhi7[20] = {};
    double errlow7[20] = {};
    double errhi8[20] = {};
    double errlow8[20] = {};
    double errhi9[20] = {};
    double errlow9[20] = {};
    double errhi10[20] = {};
    double errlow10[20] = {};
    double errhi11[20] = {};
    double errlow11[20] = {};
    double errhi12[20] = {};
    double errlow12[20] = {};
    double errhi13[20] = {};
    double errlow13[20] = {};
    double errhi14[20] = {};
    double errlow14[20] = {};
    double errhi15[20] = {};
    double errlow15[20] = {};
    double errhi16[20] = {};
    double errlow16[20] = {};
    double errhi17[20] = {};
    double errlow17[20] = {};
    double errhi18[20] = {};
    double errlow18[20] = {};
    double errhi19[20] = {};
    double errlow19[20] = {};
    double errhi20[20] = {};
    double errlow20[20] = {};
    double errhi21[20] = {};
    double errlow21[20] = {};
    double errhi22[20] = {};
    double errlow22[20] = {};
    double errhi23[20] = {};
    double errlow23[20] = {};
    //double errhi24[20] = {};
    //double errlow24[20] = {};
    double errhi25[20] = {};
    double errlow25[20] = {};
    double errhi26[20] = {};
    double errlow26[20] = {};
    double errhi27[20] = {};
    double errlow27[20] = {};
    double errhi28[20] = {};
    double errlow28[20] = {};
    double errhi29[20] = {};
    double errlow29[20] = {};
    double errhi30[20] = {};
    double errlow30[20] = {};
    double errhi31[20] = {};
    double errlow31[20] = {};
    double errhi32[20] = {};
    double errlow32[20] = {};
    double errhi33[20] = {};
    double errlow33[20] = {};
    double errhi34[20] = {};
    double errlow34[20] = {};
    //double errhi35[20] = {};
    //double errlow35[20] = {};
    double errhi36[20] = {};
    double errlow36[20] = {};
    double errhi37[20] = {};
    double errlow37[20] = {};
    double errhi38[20] = {};
    double errlow38[20] = {};
    double errhi39[20] = {};
    double errlow39[20] = {};
    double errSumhi[20] = {};
    double errSumlow[20] = {};
    double x[20] = {};
    double xerr[20] = {};
    cout << "Initializing arrays" << endl;

    double LT1 = ;
    double M1 = 0.979;
    double errM1 = 0.013;
    double LT2 = ;
    double M2 = 0.811;
    double errM2 = 0.012;
    double LT3 = ;
    double M3 = 0.968;
    double errM3 = 0.013;
    //double LT4 = ;
    //double M4 = 0.560;
    //double errM4 = 0.013;
    double LT5 = ;
    double M5 = 0.723;
    double errM5 = 0.011;
    double LT6 = ;
    double M6 = 0.659;
    double errM6 = 0.011;
    double LT7 = ;
    double M7 = 0.886;
    double errM7 = 0.012;
    double LT8 = ;
    double M8 = 0.949;
    double errM8 = 0.013;
    double LT9 = ;
    double M9 = 1.024;
    double errM9 = 0.014;
    double LT10 = ;
    double M10 = 0.558;
    double errM10 = 0.013;
    double LT11 = ;
    double M11 = 0.564;
    double errM11 = 0.013;
    double LT12 = ;
    double M12 = 0.567;
    double errM12 = 0.013;
    double LT13 = ;
    double M13 = 0.545;
    double errM13 = 0.012;
    double LT14 = ;
    double M14 = 0.557;
    double errM14 = 0.013;
    double LT15 = ;
    double M15 = 0.730;
    double errM15 = 0.011;
    double LT16 = ;
    double M16 = 0.632;
    double errM16 = 0.011;
    double LT17 = ;
    double M17 = 0.732;
    double errM17 = 0.011;
    double LT18 = ;
    double M18 = 0.701;
    double errM18 = 0.011;
    double LT19 = ;
    double M19 = 0.5722;
    double errM19 = 0.0094;
    double LT20 = ;
    double M20 = 0.561;
    double errM20 = 0.013;
    double LT21 = ;
    double M21 = 0.710;
    double errM21 = 0.011;
    double LT22 = ;
    double M22 = 0.5908;
    double errM22 = 0.009;
    double LT23 = ;
    double M23 = 0.964;
    double errM23 = 0.013;
    //double LT24 = ;
    //double M24 = 0.556;
    //double errM24 = 0.013;
    double LT25 = ;
    double M25 = 0.917;
    double errM25 = 0.012;
    double LT26 = ;
    double M26 = 0.581;
    double errM26 = 0.013;
    double LT27 = ;
    double M27 = 0.562;
    double errM27 = 0.013;
    double LT28 = ;
    double M428 = 0.559;
    double errM28 = 0.013;
    double LT29 = ;
    double M29 = 0.872;
    double errM29 = 0.012;
    double LT30 = ;
    double M30 = 0.852;
    double errM30 = 0.011;
    double LT31 = ;
    double M31 = 0.558;
    double errM31 = 0.013;
    double LT32 = ;
    double M32 = 0.579;
    double errM32 = 0.013;
    double LT33 = ;
    double M33 = 0.566;
    double errM33 = 0.013;
    double LT34 = ;
    double M34 = 0.557;
    double errM34 = 0.013;
    //double LT35 = ;
    //double M35 = 1.031;
    //double errM35 = 0.013;
    double LT36 = ;
    double M36 = 0.802;
    double errM36 = 0.011;
    double LT37 = ;
    double M37 = 0.775;
    double errM37 = 0.012;
    double LT38 = ;
    double M38 = 0.562;
    double errM38 = 0.01;
    double LT39 = ;
    double M39 = 0.567;
    double errM39 = 0.013;

    cout << "Beginning loop" << endl;
    for(int i = 0; i < 20; i++)
    {
	eff1[i] = geff1->Eval(i*5);
	eff2[i] = geff2->Eval(i*5);
    eff3[i] = geff3->Eval(i*5);
    //eff4[i] = geff4->Eval(i*5);
    eff5[i] = geff5->Eval(i*5);
    eff6[i] = geff6->Eval(i*5);
    eff7[i] = geff7->Eval(i*5);
    eff8[i] = geff8->Eval(i*5);
    eff9[i] = geff9->Eval(i*5);
    eff10[i] = geff10->Eval(i*5);
    eff11[i] = geff11->Eval(i*5);
    eff12[i] = geff12->Eval(i*5);
    eff13[i] = geff13->Eval(i*5);
    eff14[i] = geff14->Eval(i*5);
    eff15[i] = geff15->Eval(i*5);
    eff16[i] = geff16->Eval(i*5);
    eff17[i] = geff17->Eval(i*5);
    eff18[i] = geff18->Eval(i*5);
    eff19[i] = geff19->Eval(i*5);
    eff20[i] = geff20->Eval(i*5);
    eff21[i] = geff21->Eval(i*5);
    eff22[i] = geff22->Eval(i*5);
    eff23[i] = geff23->Eval(i*5);
    //eff24[i] = geff24->Eval(i*5);
    eff25[i] = geff25->Eval(i*5);
    eff26[i] = geff26->Eval(i*5);
    eff27[i] = geff27->Eval(i*5);
    eff28[i] = geff28->Eval(i*5);
    eff29[i] = geff29->Eval(i*5);
    eff30[i] = geff30->Eval(i*5);
    eff31[i] = geff31->Eval(i*5);
    eff32[i] = geff32->Eval(i*5);
    eff33[i] = geff33->Eval(i*5);
    eff34[i] = geff34->Eval(i*5);
    //eff35[i] = geff35->Eval(i*5);
    eff36[i] = geff36->Eval(i*5);
    eff37[i] = geff37->Eval(i*5);
    eff38[i] = geff38->Eval(i*5);
    eff39[i] = geff39->Eval(i*5);
	errhi1[i] = geff1->GetErrorYhigh(i);
	errlow1[i] = geff1->GetErrorYlow(i);
	errhi2[i] = geff2->GetErrorYhigh(i);
    errlow2[i] = geff2->GetErrorYlow(i);
    errhi3[i] = geff3->GetErrorYhigh(i);
    errlow3[i] = geff3->GetErrorYlow(i);
    //errhi4[i] = geff4->GetErrorYhigh(i);
    //errlow4[i] = geff4->GetErrorYlow(i);
    errhi5[i] = geff5->GetErrorYhigh(i);
    errlow5[i] = geff5->GetErrorYlow(i);
    errhi6[i] = geff6->GetErrorYhigh(i);
    errlow6[i] = geff6->GetErrorYlow(i);
    errhi7[i] = geff7->GetErrorYhigh(i);
    errlow7[i] = geff7->GetErrorYlow(i);
    errhi8[i] = geff8->GetErrorYhigh(i);
    errlow8[i] = geff8->GetErrorYlow(i);
    errhi9[i] = geff9->GetErrorYhigh(i);
    errlow9[i] = geff9->GetErrorYlow(i);
    errhi10[i] = geff10->GetErrorYhigh(i);
    errlow10[i] = geff10->GetErrorYlow(i);
    errhi11[i] = geff11->GetErrorYhigh(i);
    errlow11[i] = geff11->GetErrorYlow(i);
    errhi12[i] = geff12->GetErrorYhigh(i);
    errlow12[i] = geff12->GetErrorYlow(i);
    errhi13[i] = geff13->GetErrorYhigh(i);
    errlow13[i] = geff13->GetErrorYlow(i);
    errhi14[i] = geff14->GetErrorYhigh(i);
    errlow14[i] = geff14->GetErrorYlow(i);
    errhi15[i] = geff15->GetErrorYhigh(i);
    errlow15[i] = geff15->GetErrorYlow(i);
    errhi16[i] = geff16->GetErrorYhigh(i);
    errlow16[i] = geff16->GetErrorYlow(i);
    errhi17[i] = geff17->GetErrorYhigh(i);
    errlow17[i] = geff17->GetErrorYlow(i);
    errhi18[i] = geff18->GetErrorYhigh(i);
    errlow18[i] = geff18->GetErrorYlow(i);
    errhi19[i] = geff19->GetErrorYhigh(i);
    errlow19[i] = geff19->GetErrorYlow(i);
    errhi20[i] = geff20->GetErrorYhigh(i);
    errlow20[i] = geff20->GetErrorYlow(i);
    errhi21[i] = geff21->GetErrorYhigh(i);
    errlow21[i] = geff21->GetErrorYlow(i);
    errhi22[i] = geff22->GetErrorYhigh(i);
    errlow22[i] = geff22->GetErrorYlow(i);
    errhi23[i] = geff23->GetErrorYhigh(i);
    errlow23[i] = geff23->GetErrorYlow(i);
    //errhi24[i] = geff24->GetErrorYhigh(i);
    //errlow24[i] = geff24->GetErrorYlow(i);
    errhi25[i] = geff25->GetErrorYhigh(i);
    errlow25[i] = geff25->GetErrorYlow(i);
    errhi26[i] = geff26->GetErrorYhigh(i);
    errlow26[i] = geff26->GetErrorYlow(i);
    errhi27[i] = geff27->GetErrorYhigh(i);
    errlow27[i] = geff27->GetErrorYlow(i);
    errhi28[i] = geff28->GetErrorYhigh(i);
    errlow28[i] = geff28->GetErrorYlow(i);
    errhi29[i] = geff29->GetErrorYhigh(i);
    errlow29[i] = geff29->GetErrorYlow(i);
    errhi30[i] = geff30->GetErrorYhigh(i);
    errlow30[i] = geff30->GetErrorYlow(i);
    errhi31[i] = geff31->GetErrorYhigh(i);
    errlow31[i] = geff31->GetErrorYlow(i);
    errhi32[i] = geff32->GetErrorYhigh(i);
    errlow32[i] = geff32->GetErrorYlow(i);
    errhi33[i] = geff33->GetErrorYhigh(i);
    errlow33[i] = geff33->GetErrorYlow(i);
    errhi34[i] = geff34->GetErrorYhigh(i);
    errlow34[i] = geff34->GetErrorYlow(i);
    //errhi35[i] = geff35->GetErrorYhigh(i);
    //errlow35[i] = geff35->GetErrorYlow(i);
    errhi36[i] = geff36->GetErrorYhigh(i);
    errlow36[i] = geff36->GetErrorYlow(i);
    errhi37[i] = geff37->GetErrorYhigh(i);
    errlow37[i] = geff37->GetErrorYlow(i);
    errhi38[i] = geff38->GetErrorYhigh(i);
    errlow38[i] = geff38->GetErrorYlow(i);
    errhi39[i] = geff39->GetErrorYhigh(i);
    errlow39[i] = geff39->GetErrorYlow(i);
        
    effSum[i] = (LT1*M1*eff1[i]) + (LT2*M2*eff2[i]) + (LT3*M3*eff3[i]) + (LT5*M5*eff5[i]) + (LT6*M6*eff6[i]) + (LT7*M7*eff7[i]) + (LT8*M8*eff8[i]) + (LT9*M9*eff9[i]) + (LT10*M10*eff10[i]) + (LT11*M11*eff11[i]) + (LT12*M12*eff12[i]) + (LT13*M13*eff13[i]) + (LT14*M14*eff14[i]) + (LT15*M15*eff15[i]) + (LT16*M16*eff16[i]) + (LT17*M17*eff17[i]) + (LT18*M18*eff18[i]) + (LT19*M19*eff19[i]) + (LT20*M20*eff20[i]) + (LT21*M21*eff21[i]) + (LT22*M22*eff22[i]) + (LT23*M23*eff23[i]) + (LT25*M25*eff25[i]) + (LT26*M26*eff26[i]) + (LT27*M27*eff27[i]) + (LT28*M28*eff28[i]) + (LT29*M29*eff29[i]) + (LT30*M30*eff30[i]) + (LT31*M31*eff31[i]) + (LT32*M32*eff32[i]) + (LT33*M33*eff33[i]) + (LT34*M34*eff34[i]) + (LT37*M37*eff37[i]) + (LT38*M38*eff38[i]) + (LT39*M39*eff39[i])  ;
    errSumhi[i] = sqrt(((errhi1[i]*M1*LT1)*(errhi1[i]*M1*LT1)) + ((errM1*eff1[i]*LT1)*(errM1*eff1[i]*LT1)) + ((errhi2[i]*M2*LT2)*(errhi2[i]*M2*LT2)) + ((errM2*eff2[i]*LT2)*(errM2*eff2[i]*LT2)) + ((errhi3[i]*M3*LT3)*(errhi3[i]*M3*LT3)) + ((errM3*eff3[i]*LT3)*(errM3*eff3[i]*LT3)) + ((errhi5[i]*M5*LT5)*(errhi5[i]*M5*LT5)) + ((errM5*eff5[i]*LT5)*(errM5*eff5[i]*LT5)) + ((errhi6[i]*M6*LT6)*(errhi6[i]*M6*LT6)) + ((errM6*eff6[i]*LT6)*(errM6*eff6[i]*LT6)) + ((errhi7[i]*M7*LT7)*(errhi7[i]*M7*LT7)) + ((errM7*eff7[i]*LT7)*(errM7*eff7[i]*LT7)) + ((errhi8[i]*M8*LT8)*(errhi8[i]*M8*LT8)) + ((errM8*eff8[i]*LT8)*(errM8*eff8[i]*LT8)) + ((errhi9[i]*M9*LT9)*(errhi9[i]*M9*LT9)) + ((errM9*eff9[i]*LT9)*(errM9*eff9[i]*LT9)) + ((errhi10[i]*M10*LT10)*(errhi10[i]*M10*LT10)) + ((errM10*eff10[i]*LT10)*(errM10*eff10[i]*LT10)) + ((errhi11[i]*M11*LT11)*(errhi11[i]*M11*LT11)) + ((errM11*eff11[i]*LT11)*(errM11*eff11[i]*LT11)) + ((errhi12[i]*M12*LT12)*(errhi12[i]*M12*LT12)) + ((errM12*eff12[i]*LT12)*(errM12*eff12[i]*LT12)) + ((errhi13[i]*M13*LT13)*(errhi13[i]*M13*LT13)) + ((errM13*eff13[i]*LT13)*(errM13*eff13[i]*LT13)) + ((errhi14[i]*M14*LT14)*(errhi14[i]*M14*LT14)) + ((errM14*eff14[i]*LT14)*(errM14*eff14[i]*LT14)) + ((errhi15[i]*M15*LT15)*(errhi15[i]*M5*LT15)) + ((errM15*eff15[i]*LT15)*(errM15*eff15[i]*LT15)) + ((errhi16[i]*M16*LT16)*(errhi16[i]*M16*LT16)) + ((errM16*eff16[i]*LT16)*(errM16*eff16[i]*LT16)) + ((errhi17[i]*M17*LT17)*(errhi17[i]*M17*LT17)) + ((errM17*eff17[i]*LT17)*(errM17*eff17[i]*LT17)) + ((errhi18[i]*M18*LT18)*(errhi18[i]*M18*LT18)) + ((errM18*eff18[i]*LT18)*(errM18*eff18[i]*LT18)) + ((errhi19[i]*M19*LT19)*(errhi19[i]*M19*LT19)) + ((errM19*eff19[i]*LT19)*(errM19*eff19[i]*LT19)) + ((errhi20[i]*M20*LT20)*(errhi20[i]*M20*LT20)) + ((errM20*eff20[i]*LT20)*(errM20*eff20[i]*LT20)) + ((errhi21[i]*M21*LT21)*(errhi21[i]*M21*LT21)) + ((errM21*eff21[i]*LT21)*(errM21*eff21[i]*LT21)) + ((errhi23[i]*M23*LT23)*(errhi23[i]*M23*LT23)) + ((errM23*eff23[i]*LT23)*(errM23*eff23[i]*LT23)) + ((errhi25[i]*M25*LT25)*(errhi25[i]*M25*LT25)) + ((errM25*eff25[i]*LT25)*(errM25*eff25[i]*LT25)) + ((errhi26[i]*M26*LT26)*(errhi26[i]*M26*LT26)) + ((errM26*eff26[i]*LT26)*(errM26*eff26[i]*LT26)) + ((errhi27[i]*M27*LT27)*(errhi27[i]*M27*LT27)) + ((errM27*eff27[i]*LT27)*(errM27*eff27[i]*LT27)) + ((errhi28[i]*M28*LT28)*(errhi28[i]*M28*LT28)) + ((errM28*eff28[i]*LT28)*(errM28*eff28[i]*LT28)) + ((errhi29[i]*M29*LT29)*(errhi29[i]*M29*LT29)) + ((errM29*eff29[i]*LT29)*(errM29*eff29[i]*LT29)) + ((errhi30[i]*M30*LT30)*(errhi30[i]*M30*LT30)) + ((errM30*eff30[i]*LT30)*(errM30*eff30[i]*LT30)) + ((errhi31[i]*M31*LT31)*(errhi31[i]*M31*LT31)) + ((errM31*eff31[i]*LT31)*(errM31*eff31[i]*LT31)) + ((errhi32[i]*M32*LT32)*(errhi32[i]*M32*LT32)) + ((errM32*eff32[i]*LT32)*(errM32*eff32[i]*LT32)) + ((errhi33[i]*M33*LT33)*(errhi33[i]*M33*LT33)) + ((errM33*eff33[i]*LT33)*(errM33*eff33[i]*LT33)) + ((errhi34[i]*M34*LT34)*(errhi34[i]*M34*LT34)) + ((errM34*eff34[i]*LT34)*(errM34*eff34[i]*LT34)) + ((errhi36[i]*M36*LT36)*(errhi36[i]*M36*LT36)) + ((errM36*eff36[i]*LT36)*(errM36*eff36[i]*LT36)) + ((errhi37[i]*M37*LT37)*(errhi37[i]*M37*LT37)) + ((errM37*eff37[i]*LT37)*(errM37*eff37[i]*LT37)) + ((errhi38[i]*M38*LT38)*(errhi38[i]*M38*LT38)) + ((errM38*eff38[i]*LT38)*(errM38*eff38[i]*LT38)) + ((errhi39[i]*M39*LT39)*(errhi39[i]*M39*LT39)) + ((errM39*eff39[i]*LT39)*(errM39*eff39[i]*LT39)));
    errSumlow[i] = sqrt(((errlow1[i]*M1*LT1)*(errlow1[i]*M1*LT1)) + ((errM1*eff1[i]*LT1)*(errM1*eff1[i]*LT1)) + ((errlow2[i]*M2*LT2)*(errlow2[i]*M2*LT2)) + ((errM2*eff2[i]*LT2)*(errM2*eff2[i]*LT2)) + ((errlow3[i]*M3*LT3)*(errlow3[i]*M3*LT3)) + ((errM3*eff3[i]*LT3)*(errM3*eff3[i]*LT3)) + ((errlow5[i]*M5*LT5)*(errlow5[i]*M5*LT5)) + ((errM5*eff5[i]*LT5)*(errM5*eff5[i]*LT5)) + ((errlow6[i]*M6*LT6)*(errlow6[i]*M6*LT6)) + ((errM6*eff6[i]*LT6)*(errM6*eff6[i]*LT6)) + ((errlow7[i]*M7*LT7)*(errlow7[i]*M7*LT7)) + ((errM7*eff7[i]*LT7)*(errM7*eff7[i]*LT7)) + ((errlow8[i]*M8*LT8)*(errlow8[i]*M8*LT8)) + ((errM8*eff8[i]*LT8)*(errM8*eff8[i]*LT8)) + ((errlow9[i]*M9*LT9)*(errlow9[i]*M9*LT9)) + ((errM9*eff9[i]*LT9)*(errM9*eff9[i]*LT9)) + ((errlow10[i]*M10*LT10)*(errlow10[i]*M10*LT10)) + ((errM10*eff10[i]*LT10)*(errM10*eff10[i]*LT10)) + ((errlow11[i]*M11*LT11)*(errlow11[i]*M11*LT11)) + ((errM11*eff11[i]*LT11)*(errM11*eff11[i]*LT11)) + ((errlow12[i]*M12*LT12)*(errlow12[i]*M12*LT12)) + ((errM12*eff12[i]*LT12)*(errM12*eff12[i]*LT12)) + ((errlow13[i]*M13*LT13)*(errlow13[i]*M13*LT13)) + ((errM13*eff13[i]*LT13)*(errM13*eff13[i]*LT13)) + ((errlow14[i]*M14*LT14)*(errlow14[i]*M14*LT14)) + ((errM14*eff14[i]*LT14)*(errM14*eff14[i]*LT14)) + ((errlow15[i]*M15*LT15)*(errlow15[i]*M15*LT15)) + ((errM15*eff15[i]*LT15)*(errM15*eff15[i]*LT15)) + ((errlow16[i]*M16*LT16)*(errlow16[i]*M16*LT16)) + ((errM16*eff16[i]*LT16)*(errM16*eff16[i]*LT16)) + ((errlow17[i]*M17*LT17)*(errlow17[i]*M17*LT17)) + ((errM17*eff17[i]*LT17)*(errM17*eff17[i]*LT17)) + ((errlow18[i]*M18*LT18)*(errlow18[i]*M18*LT18)) + ((errM18*eff18[i]*LT18)*(errM18*eff18[i]*LT18)) + ((errlow19[i]*M19*LT19)*(errlow19[i]*M19*LT19)) + ((errM19*eff19[i]*LT19)*(errM19*eff19[i]*LT19)) + ((errlow20[i]*M20*LT20)*(errlow20[i]*M20*LT20)) + ((errM20*eff20[i]*LT20)*(errM20*eff20[i]*LT20)) + ((errlow21[i]*M21*LT21)*(errlow21[i]*M21*LT21)) + ((errM21*eff21[i]*LT21)*(errM21*eff21[i]*LT21)) + ((errlow22[i]*M22*LT22)*(errlow22[i]*M22*LT22)) + ((errM22*eff22[i]*LT22)*(errM22*eff22[i]*LT22)) + ((errlow23[i]*M23*LT23)*(errlow23[i]*M23*LT23)) + ((errM23*eff23[i]*LT23)*(errM23*eff23[i]*LT23)) + ((errlow25[i]*M25*LT25)*(errlow25[i]*M25*LT25)) + ((errM25*eff25[i]*LT25)*(errM25*eff25[i]*LT25)) + ((errlow26[i]*M26*LT26)*(errlow26[i]*M26*LT26)) + ((errM26*eff26[i]*LT26)*(errM26*eff26[i]*LT26)) + ((errlow27[i]*M27*LT27)*(errlow27[i]*M27*LT27)) + ((errM27*eff27[i]*LT27)*(errM27*eff27[i]*LT27)) + ((errlow28[i]*M28*LT28)*(errlow28[i]*M28*LT28)) + ((errM28*eff28[i]*LT28)*(errM28*eff28[i]*LT28)) + ((errlow29[i]*M29*LT29)*(errlow29[i]*M29*LT29)) + ((errM29*eff29[i]*LT29)*(errM29*eff29[i]*LT29)) + ((errlow30[i]*M30*LT30)*(errlow30[i]*M30*LT30)) + ((errM30*eff30[i]*LT30)*(errM30*eff30[i]*LT30)) + ((errlow31[i]*M13*LT31)*(errlow31[i]*M31*LT31)) + ((errM31*eff31[i]*LT31)*(errM31*eff31[i]*LT31)) + ((errlow32[i]*M32*LT32)*(errlow32[i]*M32*LT32)) + ((errM32*eff32[i]*LT32)*(errM32*eff32[i]*LT32)) + ((errlow33[i]*M33*LT33)*(errlow33[i]*M33*LT33)) + ((errM33*eff33[i]*LT33)*(errM33*eff33[i]*LT33)) + ((errlow34[i]*M34*LT34)*(errlow34[i]*M34*LT34)) + ((errM34*eff34[i]*LT34)*(errM34*eff34[i]*LT34)) + ((errlow36[i]*M36*LT36)*(errlow36[i]*M36*LT36)) + ((errM36*eff36[i]*LT36)*(errM36*eff36[i]*LT36)) + ((errlow37[i]*M37*LT37)*(errlow37[i]*M37*LT37)) + ((errM37*eff37[i]*LT37)*(errM37*eff37[i]*LT37)) + ((errlow38[i]*M38*LT38)*(errlow38[i]*M38*LT38)) + ((errM38*eff38[i]*LT38)*(errM38*eff38[i]*LT38)) + ((errlow39[i]*M39*LT39)*(errlow39[i]*M39*LT39)) + ((errM39*eff39[i]*LT39)*(errM39*eff39[i]*LT39)) );
	x[i] = i*5;
    xerr[i] = 0;
    }
    cout << "Loop ended" << endl;

    f1->Close();
    f2->Close();
    f3->Close();
    //f4->Close();
    f5->Close();
    f6->Close();
    f7->Close();
    f8->Close();
    f9->Close();
    f10->Close();
    f11->Close();
    f12->Close();
    f13->Close();
    f14->Close();
    f15->Close();
    f16->Close();
    f17->Close();
    f18->Close();
    f19->Close();
    f20->Close();
    f21->Close();
    f22->Close();
    f23->Close();
    //f24->Close();
    f25->Close();
    f26->Close();
    f27->Close();
    f28->Close();
    f29->Close();
    f30->Close();
    f31->Close();
    f32->Close();
    f33->Close();
    f34->Close();
    //f35->Close();
    f36->Close();
    f37->Close();
    f38->Close();
    f39->Close();
    cout << "Data files closed" << endl;

    string outFile = "~/LowE/Data/CombinedEfficiencies/ClopperErrorDS3Combined.root";
    TFile *f0 = new TFile(outFile.c_str(),"recreate");
    cout << "Creating outpout file" <<  endl;
    f0->cd();

    cout << "Creating new TGraph" << endl;
    TGraphAsymmErrors *geffSum = new TGraphAsymmErrors(20, x, effSum, xerr, xerr, errSumlow, errSumhi);
    //TGraph *geffSum =  new TGraph(20,x,effSum);
    TCanvas *c2 = new TCanvas("c2","c2",800,600);
    geffSum->SetMarkerStyle(21);
    geffSum->SetMarkerColor(kRed);
    geffSum->SetTitle("DS3 efficiency weighted exposure");
    geffSum->GetXaxis()->SetTitle("trapENFCal (keV)");
    geffSum->GetYaxis()->SetTitle("eff wt expos (kg*d)");
    //geffSum->Draw("AP");
    geffSum->Write();
    f0->Close();
    cout << "Finished" << endl;
  }
